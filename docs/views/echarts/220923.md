---
title: 'EchartJS åŒYè½´ 0åˆ»åº¦å¯¹é½å¤„ç†'
date: 2022-09-23
sidebar: "auto"
categories:
  - 
tags: 
  - Echart
---


## å¥‡æ€ªéœ€æ±‚

EchartåŒYè½´ï¼Œå¦‚æœæ•°æ®ä¸­åŒ…å«è´Ÿæ•°ï¼Œå°±ä¼šå‡ºç°0åˆ»åº¦ä¸å¯¹å…¶çš„æƒ…å†µã€‚

<img :src="$withBase('/assets/images/220923_1.png')"  alt="0åˆ»åº¦ä¸å¯¹å…¶">

ç°å®¢æˆ·å¸Œæœ›èƒ½åšåˆ°0åˆ»åº¦çº¿å¯¹é½ã€‚å› ä¸ºExcelèƒ½åšåˆ°ã€‚ğŸ˜€<br/>
æŒ‰ç†æ¥è¯´ï¼Œè¿™åº”è¯¥ç®—ä¸€ä¸ªå¸¸è§„éœ€æ±‚ï¼Œå¯Echartå¹¶æ²¡æœ‰ç›¸å…³APIå‚æ•°ã€‚<br/>


## é•œåƒ æ­£åŒºé—´éƒ¨åˆ†ï¼Œå®ç°0åˆ»åº¦çº¿å¯¹é½

<img :src="$withBase('/assets/images/220923_2.png')"  alt="é•œåƒåæ ‡è½´ä¸­çš„æ­£åŒºé—´">

é€šè¿‡é•œåƒå¤„ç†çš„æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯æŠŠåŒè½´ä¸­çš„æœ€å¤§å€¼ï¼Œåˆ†åˆ«è®¾ç½®åˆ°Min Maxä¸­ã€‚<br/>
å°±å¯ä»¥å®Œæˆ0åˆ»åº¦çº¿å¯¹é½ã€‚


```javascript
		// æ•°æ®
			var LeftNum = [503, 1689, 118, 165, 686, 662, 645, 320, 15, -113, 40, 143, 740, 182, -29];
			var LeftData = {
				max: Math.max(...LeftNum),
				min: Math.min(...LeftNum)
			}
			var RightNum = [2, 0, 6, 2, 2, 3, 11, 6, 7, 4, 1, 2, 1, 6, 7];
			var RightData = {
				max: Math.max(...RightNum),
				min: Math.min(...RightNum)
			}
			console.log(LeftData)
			console.log(RightData)
			// é€‰ä¸­é¡¹
			var selected = {
				æ³¨å†Œ: true,
				æ´»è·ƒ: true
			}


			var dom = document.getElementById("container");
			var myChart = echarts.init(dom);
			var app = {};
			option = null;

			option = {
				//1ã€ æ ¼å¼åŒ–æç¤ºä¿¡æ¯
				tooltip: {
					trigger: 'axis',
				},
				toolbox: {
					feature: {
						dataView: {
							show: true,
							readOnly: false
						},
						magicType: {
							show: true,
							type: ['line', 'bar']
						},
						restore: {
							show: true
						},
						saveAsImage: {
							show: true
						}
					}
				},
				legend: {
					data: ['æ³¨å†Œ', 'æ´»è·ƒ'],
					selected,
				},
				grid: {
					width: '50%',
					height: '50%'
				},
				xAxis: [{
					type: 'category',
					data: [
						"2022-08-31",
						"2022-09-01",
						"2022-09-02",
						"2022-09-03",
						"2022-09-04",
						"2022-09-05",
						"2022-09-06",
						"2022-09-07",
						"2022-09-08",
						"2022-09-09",
						"2022-09-10",
						"2022-09-11",
						"2022-09-12",
						"2022-09-13",
						"2022-09-14"
					],
					axisPointer: {
						type: 'shadow'
					}
				}],
				yAxis: [{
						type: 'value',
						name: 'æ³¨å†Œ',
						max: function(value) {
							if (Math.abs(value.max) > Math.abs(value.min)) {
								return (Math.abs(value.max)).toFixed(2);
							} else {
								return (Math.abs(value.min)).toFixed(2);
							}
						},
						min: function(value) {
							if (Math.abs(value.max) > Math.abs(value.min)) {
								return (-Math.abs(value.max)).toFixed(2);
							} else {
								return (-Math.abs(value.min)).toFixed(2);
							}
						}
					},
					{
						type: 'value',
						name: 'æ´»è·ƒ',
						max: function(value) {
							if (Math.abs(value.max) > Math.abs(value.min)) {
								return (Math.abs(value.max)).toFixed(2);
							} else {
								return (Math.abs(value.min)).toFixed(2);
							}
						},
						min: function(value) {
							if (Math.abs(value.max) > Math.abs(value.min)) {
								return (-Math.abs(value.max)).toFixed(2);
							} else {
								return (-Math.abs(value.min)).toFixed(2);
							}
						}
					}
				],
				series: [{
						name: 'æ³¨å†Œ',
						type: 'bar',
						data: LeftNum
					},
					{
						name: 'æ´»è·ƒ',
						type: 'bar',
						yAxisIndex: 1,
						data: RightNum
					},

				]
			};

			if (option && typeof option === "object") {
				myChart.setOption(option, true);
				myChart.on('legendselectchanged', function(params) {
					option.legend.selected = params.selected
					selected = params.selected
					myChart.setOption(option);
				})
			}
```


## é€šè¿‡æ¯”ä¾‹è®¡ç®—æœ€å°å€¼

é€šè¿‡é•œåƒæ­£åŒºé—´çš„æ–¹å¼ï¼Œèƒ½å®ç°æ•ˆæœï¼Œä½†æ˜¯ä¸å°½å¦‚æ„ã€‚ä¸‹æ–¹ç•™ç™½ä¼šè¿‡å¤š<br/>

ä»ä¸Šå›¾ä¸­åˆ†æå¯ä»¥çŸ¥é“ï¼š<br/>
  - 1.æ­£åŒºé—´åŒè½´æœ€å¤§å€¼å¯ä»¥ä»æ•°æ®ä¸­ç®—å‡º
  - 2.è´ŸåŒºé—´åŒè½´æœ€å¤§å€¼ä¹Ÿæ˜¯å¯ä»¥ç®—å‡ºæ¥çš„
  - 3.åªæœ‰è´ŸåŒºé—´çš„è¾ƒå°å€¼éœ€è¦é€šè¿‡æ¯”ä¾‹è®¡ç®—

é€šè¿‡åˆ—æ–¹ç¨‹ç®€åŒ–åå¯è§£å¾—ï¼š`min1 = max1 * min2 / max2`
  - min1 max1 è¡¨ç¤ºè´ŸåŒºé—´ä¸­çš„è¾ƒå°å€¼çš„è½´ï¼Œå›¾ä¸­å³è½´
  - min2 max2 è¡¨ç¤ºè´ŸåŒºé—´ä¸­çš„è¾ƒå¤§å€¼çš„è½´ï¼Œå›¾ä¸­å·¦è½´

<img :src="$withBase('/assets/images/220923_3.png')"  alt="é€šè¿‡æ¯”ä¾‹è®¡ç®—æœ€å°å€¼">

```javascript
					// æ•°æ®
		var LeftNum = [0, 1336, 0, 0, 0, 0, 100, 0, 0, 0, 0, 0, 0, 0, ]
		//var LeftNum = [503, 1689, 118, 165, 686, 662, 645, 320, 15, -113, 40, 143, 740, 182, -29];

		var LeftData = {
			max: Math.max(...LeftNum),
			min: Math.min(...LeftNum)
		}
		var RightNum = [-571840, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
		//var RightNum = [2, 0, 6, 2, 2, 3, 11, 6, 7, 4, 1, 2, 1, 6, 7];

		var RightData = {
			max: Math.max(...RightNum),
			min: Math.min(...RightNum)
		}
		console.log(LeftData)
		console.log(RightData)
		// é€‰ä¸­é¡¹
		var selected = {
			æ³¨å†Œ: true,
			æ´»è·ƒ: true
		}


		var dom = document.getElementById("container");
		var myChart = echarts.init(dom);
		var app = {};
		option = null;

		option = {
			//1ã€ æ ¼å¼åŒ–æç¤ºä¿¡æ¯
			tooltip: {
				trigger: 'axis',
			},
			toolbox: {
				feature: {
					dataView: {
						show: true,
						readOnly: false
					},
					magicType: {
						show: true,
						type: ['line', 'bar']
					},
					restore: {
						show: true
					},
					saveAsImage: {
						show: true
					}
				}
			},
			legend: {
				data: ['æ³¨å†Œ', 'æ´»è·ƒ'],
				selected,
			},
			grid: {
				width: '50%',
				height: '50%'
			},
			xAxis: [{
				type: 'category',
				data: [
					"2022-09-01",
					"2022-09-02",
					"2022-09-03",
					"2022-09-04",
					"2022-09-05",
					"2022-09-06",
					"2022-09-07",
					"2022-09-08",
					"2022-09-09",
					"2022-09-10",
					"2022-09-11",
					"2022-09-12",
					"2022-09-13",
					"2022-09-14"
				],
				axisPointer: {
					type: 'shadow'
				}
			}],
			yAxis: [{
					type: 'value',
					name: 'æ³¨å†Œ',
					min: function(value) {
						let t = Min(value, 'left')
						console.log("Left", t);
						return t;
					},
					max: function(value) {
						return Max(value)
					}
				},
				{
					type: 'value',
					name: 'æ´»è·ƒ',
					min: function(value) {
						let t = Min(value, 'right')
						console.log("Right", t);
						return t;
					},
					max: function(value) {
						return Max(value)
					}
				}
			],
			series: [{
					name: 'æ³¨å†Œ',
					type: 'bar',
					data: LeftNum
				},
				{
					name: 'æ´»è·ƒ',
					type: 'bar',
					yAxisIndex: 1,
					data: RightNum
				},

			]
		};

		if (option && typeof option === "object") {
			myChart.setOption(option, true);
			myChart.on('legendselectchanged', function(params) {
				option.legend.selected = params.selected
				selected = params.selected
				myChart.setOption(option);
			})
		}

		// è®¡ç®—æœ€å°å€¼
		function Min(value, direction) {
			if (LeftData.min >= 0 && RightData.min >= 0) {
				return 0;
			}
			if (direction === 'left') {
				if (Math.abs(LeftData.min) > Math.abs(RightData.min)) {
					return LeftData.min;
				} else {
					if (RightData.max === 0) {
						return -Math.abs(LeftData.max)
					}
					// max1 * min2 / max2
					let t = LeftData.max * RightData.min / RightData.max;
					return t;
				}
			}
			if (direction === 'right') {
				if (Math.abs(RightData.min) > Math.abs(LeftData.min)) {
					return RightData.min;
				} else {
					if (LeftData.max === 0) {
						return -Math.abs(RightData.max)
					}
					// max1 * min2 / max2
					let t = RightData.max * LeftData.min / LeftData.max;
					return t;
				}
			}

		}

		function Max(value) {
			console.log("MAX", value);
			if (value.max === 0) {
				return Math.abs(value.min)
			}
			return value.max;
		}
```

## æœ€å

å­¦å¥½æ•°å­¦æ˜¯å¾ˆé‡è¦æ»´ï¼ğŸ˜€